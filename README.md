# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Паттерн

Сайт использует паттерн MVP (Model View Presenter)

Слой Model отвечает за обработку логики и данных сайта - здесь происходит формирование каталога товаров,полученных с сервера с помощью API, валидация форм и формирование корзины

Слой View отвечает за обработку элементов UI с которыми взаимодействует пользователь

Слой Prersenter отвечает за обработку данных введенных пользователем отправку/получение данных из Модели и обновление элементов View

## Компоненты моделей данных

Отвечает за получение и отправку данных о товарах, заказах и формах

### Класс Catalog: IShopItem[] - массив товаров, полученный с сервера

Методы класса:

setItems(items: IShopItem[]):void; - сохрание массива товара в модели после получения из api\
getItem(id: string): IShopItem; - получение массива товаров каталога
 getItems(): IShopItem[] - получение массива товаров содержащихся в каталоге

### Класс BasketModel - массив товаров в корзине

Поля класса - массив товаров с названиями и количеством товара в корзине

Методы класса:

add (id: string): void; - добавление товара в корзину\
remove (id: string): void; - удаление товара из корзины\
clearBasket(): void - очищает корзину\
calculateTotal(): number - высчитывает стоимость товаров в корзине
 getItems(): Map<string, number> - возврииащает Map содержащий id предметов в корзине

### Класс OrderModel

Отвечает за валидацию данных введенных в форму, хранение данных заказа

Поля:

payment: string - выбранный способ оплаты\
address: - адрес доставки\
email: string - почта\
phone: string - телефон\
formErrors: string[] - массив текста для ошибок
events: IEvents; - евент эмиттер

Методы:

  setOrderField(field: keyof IOrderForm, value: string) - записывает в модель данные введенные пользователем
   validateOrder() валидирует заказа
     clearOrder() - очищает данные в заказе после его отправки на сервер

### Класс ShopAPI : IShopAPI

Поля класса включают в сеья данные необходимые для формирования запросов к серверу

Методы:

    getItems: () => Promise<IShopItem[]> - отпарвляет GET запрос на получение данных о товарах
    getItem: (id: string) => Promise<IShopItem> - отправляет запрос на получение данных конкретного предмета по его ID
    placeOrder(basket: Array<string>, order: OrderModel, total: number): Promise<IOrderResult> - отправляет POST запрос с данными заказа и предметами в корзине




## Компоненты Представления

### Класс Form : IformState

Собирает данные ввекденные в формы и создает необходимые ивенты, обновляет разметку форм

Поля:

_submit: HTMLButtonElement; - элемент разметки ошибки 
_errors: HTMLElement; - элемент разметки кнопки отправления формы

Методы:
onInputChange(field: keyof T, value: string) - при введении данных в элемент формы эмитит соответсвующее событие
сеттер valid разблокирует элементы кнопок при успешной валидации 
сеттер errors ответсвененн за отображения текста ошибок валидации

### Класс Page

Отвечает за отображение страницы

Поля класса:

_сounter: HTMLElement- счетчик товаров в корзине\
_catalog: HTMLElement - коллекция всех товаров на странице\
_wrapper: HTMLElement - "обертка" страницы\
_basket: HTMLElement - кнопка корзины

Методы класса:
set locked : блокирует прокрутку страницы
set counter : управление счетчиком товаров в крозине
set catalog: наполнение каталога товаров

### Класс Modal

отвечает за отображение модальных окон. Наследует Component

Поля класса: 

  protected _closeButton: HTMLButtonElement; - кнопка закрытия модального окна
    protected _content: HTMLElement; - контент модального окна, меняется в зависимости от того какое модальное окно нужно отобразить

Методы класса:

set content: добавляет в основной контейнер модального окна нужную разметку в зависмости от задачи модального окна
open() - открывает модальное окно\
close() - закрывает модальное окно\
render(data: IModalData): HTMLElement - вовзращает корневой элемент при изменении

### Класс BasketView

Отображение элементов корзины в соответсвующем модальном окне списка покупок и суммы покупок. Наследует Component и его методы

Поля

total: number - разметка суммы товаров в корзине
 list: HTMLElement[] - лист товаров в корзине
buttonDisabled: boolean - состояние кнопки оформления заказа

Методы:

ceттеры total и list отвечают за наполнение желемента суммы и листа покупок в корзине
  set buttonDisabled (value: boolean) - отвечает за состояние кнопки оформления заказа

### Класс Success 

Отображение разметки и суммы списания в окне успешного оформления товаров. Наследует Component  и его методы

Поля класса: 
total: number; - счетчик суммы заказа

Методы:

сеттер total 


### Класс Card

Отображение разметки карточки товара на странице  и его методы

Поля класса: 
 protected _cardTitle: HTMLElement; - название карточки
    protected _cardButton: HTMLButtonElement; эелемент кнопки заказа вызывающее модальное окно с товаром
    protected _cardImage: HTMLImageElement; - картинка товара
    protected _cardPrice: HTMLElement; - элемент стоимсоти товара
    protected _cardCategory: HTMLElement; - категория товара
    protected _id: string; - id товара

Методы:

cеттеры соотвествующих элементов разметки 



### Класс Preview

отображение разметки описания продукта в модальном окне  и его методы

Поля класса: 
     protected _previewTitle: HTMLElement;
    protected _previewAddButton: HTMLButtonElement;
    protected _previewImage: HTMLImageElement;
    protected _previewPrice: HTMLElement;
    protected _previewCategory: HTMLElement;
    protected _previewDescription: HTMLElement;
    protected _id: string;

    Методы:

    cеттеры соотвествующих элементов разметки 
    buttonState(value: boolean): void  - переключатель состояния кнопки в зависимости от того находится ли товар в корзине

### Класс OrderView

отображение формы заполнения адреса и выбора метода оплаты наследует Form

Поля:
   protected _cashButton: HTMLButtonElement - элемент разметки кнопки 
    protected _cardButton: HTMLButtonElement - - элемент разметки кнопки 

Методы:

сеттеры полей

 setActiveButton(value:string) : void  - опеределяет состояние кнопок выбора метода оплаты
    

### Класс Conctact view

отображение формы заполнения контактов наследует Form

методы:
сеттеры полей

## Компоненты Презентера

Приложение является одностраничным сайтом - достаточного одного презентера, который будет размещен в основном скрипте index.ts

## Типы данных

### интерфейс товара
```
interface IShopItem {
    id: string; //id товара
    description: string; //подробное описание товара
    image: string; //ссылка на изображение товара
    title: string; // название товара
    category: string; // категория товара
    price: number | null;; // цена товара
}
```
### интерфейс заказа
```
interface IOrderForm {
    payment: string; //метод олплаты либо онлайн либо при получении
    address: string; // адрес доставки
    email: string; // почта
    phone: string; // телефон

}
```
## Процессы

Событийно-ориентированный подход

1. Открыть/Закрыть модальное окно товара
2. Добавить 1 единицу товара в корзину
3. Убрать 1 единицу товара из корзины
4. Открыть/Закрыть модальное окно корзины
5. Убрать товар из корзины
6. Перейти к оформлению заказа (Открытие модального окна оформления заказа)
7. Выбор способа оплаты и указание адреса
8. Указание контактных данных 
9. Оформление заказа и получение уведомления о списании средств
